//! é€šç”¨é€»è¾‘
//! * ğŸ¯ã€2024-03-17 17:43:49ã€‘ç”¨äºå­˜å‚¨ã€Œæ•°ç»„ï¼ˆåˆ‡ç‰‡ï¼‰æœç´¢ã€ç®—æ³•
//!   * ğŸ“Œé€‰æ‹©æ€§ä¾èµ–[`crate::algorithms`]åŒ…

use std::cmp::Ordering;

/// æœç´¢ | ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾
/// * ğŸ“Œå†…éƒ¨ä½¿ç”¨çš„æœç´¢å‡½æ•°
#[cfg(feature = "algorithms")]
#[inline(always)]
pub(super) fn search_by<T1, T2, F>(arr: &[T1], target: &T2, cmp: F) -> Result<usize, usize>
where
    F: Fn(&T2, &T1) -> Ordering,
{
    // é‡å®šå‘åˆ°ã€ŒäºŒåˆ†æŸ¥æ‰¾ã€
    crate::algorithms::binary_search_by(arr, target, cmp)
}

/// æœç´¢ | ä½¿ç”¨çº¿æ€§æŸ¥æ‰¾
/// * ğŸ“Œå†…éƒ¨é»˜è®¤ä½¿ç”¨çš„æœç´¢å‡½æ•°
#[cfg(not(feature = "algorithms"))]
#[inline(always)]
pub fn search_by<T1, T2, F>(arr: &[T1], target: &T2, cmp: F) -> Result<usize, usize>
where
    F: Fn(&T2, &T1) -> Ordering,
{
    // é‡å®šå‘åˆ°ã€Œçº¿æ€§æŸ¥æ‰¾ã€
    linear_search_by(arr, target, cmp)
}

/// çº¿æ€§æŸ¥æ‰¾ï¼ˆä½¿ç”¨ã€Œåˆ¤æ®å‡½æ•°ã€æ¯”å¯¹å¤§å°ï¼‰
/// * ğŸ¯ã€Œå‰åç¼€åŒ¹é…ã€åœ¨æ²¡ä½¿ç”¨[`crate::algorithms`]æ—¶çš„é»˜è®¤ç®—æ³•
/// * ğŸ¯ç”¨äºå¯¹æŸä¸ª**å·²æ’å¥½åº**çš„å…ƒç´ çš„æŸ¥æ‰¾
///   * ç”±æ­¤å¯ç”¨äºä»é›¶æ¸è¿‘æ„é€ æœ‰åºåºåˆ—
/// * ğŸ¯æ‰¾åˆ°æŸä¸ªå…ƒç´ çš„ä½ç½®ï¼Œæˆ–è‡³å°‘åæ˜ ã€Œå®ƒåº”è¯¥è¢«æ’å…¥çš„ä½ç½®ã€
///   * æ­¤å¤„ã€Œåº”è¯¥è¢«æ’å…¥çš„ä½ç½®ã€æŒ‡çš„æ˜¯ã€Œæ’å…¥ä¹‹åå®ƒçš„ç´¢å¼•ã€
///   * äº¦å³ã€Œæ’å…¥ä¹‹åä¼šæŠŠå½“å‰ä½ç½®çš„å…ƒç´ åç§»ã€
///   * æˆ–ã€Œç¬¬ä¸€ä¸ªå°äºè¯¥å…ƒç´ ã€çš„ä½ç½®
///   * ğŸ“Œæ ¸å¿ƒåœ¨ã€Œæ’å…¥åä¿æŒã€æ¯”è‡ªå·±å¤§çš„ > è‡ªå·± > å·²å­˜åœ¨ã€çš„é¡ºåºã€
pub fn linear_search_by<T1, T2, F>(arr: &[T1], target: &T2, cmp: F) -> Result<usize, usize>
where
    F: Fn(&T2, &T1) -> Ordering,
{
    for (i, existed) in arr.iter().enumerate() {
        match cmp(target, existed) {
            // è‡ªå·± = å·²å­˜åœ¨ â‡’ å¦‚æœç­‰äºï¼Œç›´æ¥è¿”å›è¿™ä¸ªä½ç½®
            Ordering::Equal => return Ok(i),
            // è‡ªå·± < å·²å­˜åœ¨ â‡’ ç¡®ä¿åŒ¹é…åˆ°ã€Œç¬¬ä¸€ä¸ªæ¯”è‡ªå·±å°çš„ã€ç„¶åæ›¿ä»£å®ƒçš„ä½ç½®
            // * ğŸ“Œä¿è¯æ’å…¥åã€Œæ¯”è‡ªå·±å¤§çš„ > è‡ªå·± > å·²å­˜åœ¨ã€
            Ordering::Less => return Err(i),
            // è‡ªå·± < å·²å­˜åœ¨ â‡’ ç»§ç»­
            Ordering::Greater => (),
        }
    }
    // å¦åˆ™æ’å…¥æœ«å°¾
    Err(arr.len())
}
